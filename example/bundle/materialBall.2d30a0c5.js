var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},n={},t=e.parcelRequire5b70;null==t&&((t=function(e){if(e in a)return a[e].exports;if(e in n){var t=n[e];delete n[e];var r={id:e,exports:{}};return a[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,a){n[e]=a},e.parcelRequire5b70=t);var r=t("ilwiq"),i=t("RPVlj"),o=t("7lx9d"),s=t("5Rd1x"),l=t("4CEV9"),d=t("cVdfP"),c=t("891vQ"),m=t("kp7Te"),h=t("jiuw3");let g,u,p,C,R,w,v,b,y,S,T,f,M,I;const k={material1:{color:"#ffc766",emissive:"#000000",emissiveIntensity:1,roughness:.1,metalness:.8,ior:1.495,transmission:0,opacity:1,clearcoat:0,clearcoatRoughness:0,sheenColor:"#000000",sheenRoughness:0,iridescence:0,iridescenceIOR:1.5,iridescenceThickness:400,matte:!1,castShadow:!0},material2:{color:"#db7157",emissive:"#000000",emissiveIntensity:1,roughness:.8,metalness:.1,transmission:0,ior:1.495,opacity:1,clearcoat:0,clearcoatRoughness:0,sheenColor:"#000000",sheenRoughness:0,iridescence:0,iridescenceIOR:1.5,iridescenceThickness:400,matte:!1,castShadow:!0},material3:{color:"#000000",roughness:.01,metalness:.05,clearcoat:0,clearcoatRoughness:0,sheenColor:"#000000",sheenRoughness:0,iridescence:0,iridescenceIOR:1.5,iridescenceThickness:400,matte:!1,castShadow:!0},multipleImportanceSampling:!0,stableNoise:!1,environmentIntensity:1,environmentRotation:0,environmentBlur:0,backgroundBlur:0,bounces:5,samplesPerFrame:1,acesToneMapping:!0,resolutionScale:1/window.devicePixelRatio,transparentTraversals:20,filterGlossyFactor:.5,tiles:1,backgroundAlpha:1,checkerboardTransparency:!0,cameraProjection:"Perspective"};window.location.hash.includes("transmission")&&(k.material1.metalness=0,k.material1.roughness=.05,k.material1.transmission=1,k.material1.color="#ffffff",k.bounces=10);function x(){const e=window.innerWidth,a=window.innerHeight,n=k.resolutionScale,t=window.devicePixelRatio;C.setSize(e*n*t,a*n*t),C.reset(),g.setSize(e,a),g.setPixelRatio(window.devicePixelRatio*n);const r=e/a;b.aspect=r,b.updateProjectionMatrix();const i=5/r;y.top=i/2,y.bottom=i/-2,y.updateProjectionMatrix()}function F(){C.reset()}function P(){const e=f.generate(T,k.environmentBlur);C.material.envMapInfo.updateFrom(e),M.environment=e,C.reset()}function B(e){"Perspective"===e?(R&&b.position.copy(R.position),R=b):"Orthographic"===e?(R&&y.position.copy(R.position),R=y):(R&&S.position.copy(R.position),R=S),u.object=R,C.camera=R,u.update(),F()}function E(){requestAnimationFrame(E);const e=v[0];e.color.set(k.material1.color).convertSRGBToLinear(),e.emissive.set(k.material1.emissive).convertSRGBToLinear(),e.emissiveIntensity=k.material1.emissiveIntensity,e.metalness=k.material1.metalness,e.roughness=k.material1.roughness,e.transmission=k.material1.transmission,e.ior=k.material1.ior,e.opacity=k.material1.opacity,e.clearcoat=k.material1.clearcoat,e.clearcoatRoughness=k.material1.clearcoatRoughness,e.sheenColor.set(k.material1.sheenColor).convertSRGBToLinear(),e.sheenRoughness=k.material1.sheenRoughness,e.iridescence=k.material1.iridescence,e.iridescenceIOR=k.material1.iridescenceIOR,e.iridescenceThicknessRange=[0,k.material1.iridescenceThickness];const a=v[1];a.color.set(k.material2.color).convertSRGBToLinear(),a.emissive.set(k.material2.emissive).convertSRGBToLinear(),a.emissiveIntensity=k.material2.emissiveIntensity,a.metalness=k.material2.metalness,a.roughness=k.material2.roughness,a.transmission=k.material2.transmission,a.ior=k.material2.ior,a.opacity=k.material2.opacity,a.clearcoat=k.material2.clearcoat,a.clearcoatRoughness=k.material2.clearcoatRoughness,a.sheenColor.set(k.material2.sheenColor).convertSRGBToLinear(),a.sheenRoughness=k.material2.sheenRoughness,a.iridescence=k.material2.iridescence,a.iridescenceIOR=k.material2.iridescenceIOR,a.iridescenceThicknessRange=[0,k.material2.iridescenceThickness];const n=v[2];n.color.set(k.material3.color).convertSRGBToLinear(),n.metalness=k.material3.metalness,n.roughness=k.material3.roughness,n.clearcoat=k.material3.clearcoat,n.clearcoatRoughness=k.material3.clearcoatRoughness,n.sheenColor.set(k.material3.sheenColor).convertSRGBToLinear(),n.sheenRoughness=k.material3.sheenRoughness,n.iridescence=k.material3.iridescence,n.iridescenceIOR=k.material3.iridescenceIOR,n.iridescenceThicknessRange=[0,k.material3.iridescenceThickness],C.material.materials.updateFrom(p.materials,p.textures),C.material.materials.setMatte(0,k.material1.matte),C.material.materials.setMatte(1,k.material2.matte),C.material.materials.setMatte(2,k.material3.matte),C.material.materials.setCastShadow(0,k.material1.castShadow),C.material.materials.setCastShadow(1,k.material2.castShadow),C.material.materials.setCastShadow(2,k.material3.castShadow),C.material.filterGlossyFactor=k.filterGlossyFactor,C.material.environmentIntensity=k.environmentIntensity,C.material.backgroundBlur=k.backgroundBlur,C.material.bounces=k.bounces,C.material.backgroundAlpha=k.backgroundAlpha,C.material.physicalCamera.updateFrom(R),R.updateMatrixWorld(),k.backgroundAlpha<1?M.background=null:M.background=M.environment;for(let e=0,a=k.samplesPerFrame;e<a;e++)C.update();C.samples<1&&g.render(M,R),g.autoClear=!1,w.material.map=C.target.texture,w.render(g),g.autoClear=!0,I.innerText=`Samples: ${Math.floor(C.samples)}`}window.innerWidth/window.innerHeight<.65&&(k.bounces=Math.max(k.bounces,6),k.resolutionScale*=.5,k.tiles=2,k.multipleImportanceSampling=!1,k.environmentBlur=.35),async function(){g=new r.WebGLRenderer({antialias:!0}),g.toneMapping=r.ACESFilmicToneMapping,g.outputEncoding=r.sRGBEncoding,g.setClearColor(0,0),document.body.appendChild(g.domElement);const e=window.innerWidth/window.innerHeight;b=new l.PhysicalCamera(75,e,.025,500),b.position.set(-4,2,3);const a=5/e;y=new r.OrthographicCamera(-2.5,2.5,a/2,a/-2,0,100),y.position.set(-4,2,3),S=new l.EquirectCamera,S.position.set(-4,2,3),C=new l.PathTracingRenderer(g),C.alpha=!0,C.material=new l.PhysicalPathTracingMaterial,C.material.setDefine("TRANSPARENT_TRAVERSALS",k.transparentTraversals),C.material.setDefine("FEATURE_MIS",Number(k.multipleImportanceSampling)),C.tiles.set(k.tiles,k.tiles),w=new i.FullScreenQuad(new r.MeshBasicMaterial({map:C.target.texture,blending:r.CustomBlending})),u=new s.OrbitControls(b,g.domElement),u.addEventListener("change",(()=>{C.reset()})),M=new r.Scene,I=document.getElementById("samples"),f=new l.BlurredEnvMapGenerator(g);const n=new Promise((e=>{(new c.RGBELoader).load("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/equirectangular/royal_esplanade_1k.hdr",(a=>{T=a,P(),e()}))})),t=new d.PathTracingSceneWorker,R=(new o.GLTFLoader).setMeshoptDecoder(m.MeshoptDecoder).loadAsync("https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/material-balls/material_ball_v2.glb").then((e=>{const a=new r.Group;e.scene.scale.setScalar(.01),e.scene.updateMatrixWorld(),a.add(e.scene);const n=new r.Box3;n.setFromObject(e.scene);const i=new r.Mesh(new r.CylinderBufferGeometry(3,3,.05,200),new r.MeshPhysicalMaterial({color:16777215,roughness:0,metalness:.25}));i.geometry=i.geometry.toNonIndexed(),i.geometry.clearGroups(),i.position.y=n.min.y-.03,a.add(i);const o=new r.MeshPhysicalMaterial,s=new r.MeshPhysicalMaterial;return e.scene.traverse((e=>{e.geometry&&e.geometry.computeVertexNormals(),"Sphere_1"===e.name?e.material=s:e.material=o,"subsphere_1"===e.name&&(e.material=s)})),v=[o,s,i.material],t.generate(a)})).then((e=>{p=e,M.add(e.scene);const{bvh:a,textures:n,materials:r}=e,i=a.geometry,o=C.material;o.bvh.updateFrom(a),o.normalAttribute.updateFrom(i.attributes.normal),o.tangentAttribute.updateFrom(i.attributes.tangent),o.uvAttribute.updateFrom(i.attributes.uv),o.materialIndexAttribute.updateFrom(i.attributes.materialIndex),o.textures.setTextures(g,2048,2048,n),o.materials.updateFrom(r,n),t.dispose()}));await Promise.all([R,n]),document.getElementById("loading").remove(),document.body.classList.add("checkerboard"),x(),window.addEventListener("resize",x);const A=new h.GUI;B(k.cameraProjection);const G=A.addFolder("Path Tracing");G.add(k,"acesToneMapping").onChange((e=>{g.toneMapping=e?r.ACESFilmicToneMapping:r.NoToneMapping,w.material.needsUpdate=!0})),G.add(k,"stableNoise").onChange((e=>{C.stableNoise=e})),G.add(k,"multipleImportanceSampling").onChange((e=>{C.material.setDefine("FEATURE_MIS",Number(e)),C.reset()})),G.add(k,"tiles",1,4,1).onChange((e=>{C.tiles.set(e,e)})),G.add(k,"samplesPerFrame",1,10,1),G.add(k,"filterGlossyFactor",0,1).onChange((()=>{C.reset()})),G.add(k,"bounces",1,30,1).onChange((()=>{C.reset()})),G.add(k,"transparentTraversals",0,40,1).onChange((e=>{C.material.setDefine("TRANSPARENT_TRAVERSALS",e),C.reset()})),G.add(k,"resolutionScale",.1,1).onChange((()=>{x()}));const L=A.addFolder("Environment");L.add(k,"environmentIntensity",0,10).onChange((()=>{C.reset()})),L.add(k,"environmentRotation",0,2*Math.PI).onChange((e=>{C.material.environmentRotation.setFromMatrix4((new r.Matrix4).makeRotationY(e)),C.reset()})),L.add(k,"environmentBlur",0,1).onChange((()=>{P()})),L.add(k,"backgroundBlur",0,1).onChange((()=>{C.reset()})),L.add(k,"backgroundAlpha",0,1).onChange((()=>{C.reset()})),L.add(k,"checkerboardTransparency").onChange((e=>{e?document.body.classList.add("checkerboard"):document.body.classList.remove("checkerboard")}));const O=A.addFolder("Camera");O.add(k,"cameraProjection",["Perspective","Orthographic","Equirectangular"]).onChange((e=>{B(e)})),O.add(b,"focusDistance",1,100).onChange(F),O.add(b,"apertureBlades",0,10,1).onChange((function(e){b.apertureBlades=0===e?0:Math.max(e,3),this.updateDisplay(),F()})),O.add(b,"apertureRotation",0,12.5).onChange(F),O.add(b,"anamorphicRatio",.1,10).onChange(F),O.add(b,"bokehSize",0,50).onChange(F).listen(),O.add(b,"fStop",.3,20).onChange(F).listen(),O.add(b,"fov",25,100).onChange((()=>{b.updateProjectionMatrix(),F()})).listen();const N=A.addFolder("Shell Material");N.addColor(k.material1,"color").onChange(F),N.addColor(k.material1,"emissive").onChange(F),N.add(k.material1,"emissiveIntensity",0,50,.01).onChange(F),N.add(k.material1,"roughness",0,1).onChange(F),N.add(k.material1,"metalness",0,1).onChange(F),N.add(k.material1,"opacity",0,1).onChange(F),N.add(k.material1,"transmission",0,1).onChange(F),N.add(k.material1,"ior",.9,3).onChange(F),N.add(k.material1,"clearcoat",0,1).onChange(F),N.add(k.material1,"clearcoatRoughness",0,1).onChange(F),N.addColor(k.material1,"sheenColor").onChange(F),N.add(k.material1,"sheenRoughness",0,1).onChange(F),N.add(k.material1,"iridescence",0,1).onChange(F),N.add(k.material1,"iridescenceIOR",.1,3).onChange(F),N.add(k.material1,"iridescenceThickness",0,1200).onChange(F),N.add(k.material1,"matte").onChange(F),N.add(k.material1,"castShadow").onChange(F),N.close();const j=A.addFolder("Ball Material");j.addColor(k.material2,"color").onChange(F),j.addColor(k.material2,"emissive").onChange(F),j.add(k.material2,"emissiveIntensity",0,50,.01).onChange(F),j.add(k.material2,"roughness",0,1).onChange(F),j.add(k.material2,"metalness",0,1).onChange(F),j.add(k.material2,"opacity",0,1).onChange(F),j.add(k.material2,"transmission",0,1).onChange(F),j.add(k.material2,"ior",.9,3).onChange(F),j.add(k.material2,"clearcoat",0,1).onChange(F),j.add(k.material2,"clearcoatRoughness",0,1).onChange(F),j.addColor(k.material2,"sheenColor").onChange(F),j.add(k.material2,"sheenRoughness",0,1).onChange(F),j.add(k.material2,"iridescence",0,1).onChange(F),j.add(k.material2,"iridescenceIOR",.1,3).onChange(F),j.add(k.material2,"iridescenceThickness",0,1200).onChange(F),j.add(k.material2,"matte").onChange(F),j.add(k.material2,"castShadow").onChange(F),j.close();const _=A.addFolder("Floor Material");_.addColor(k.material3,"color").onChange(F),_.add(k.material3,"roughness",0,1).onChange(F),_.add(k.material3,"metalness",0,1).onChange(F),_.add(k.material3,"clearcoat",0,1).onChange(F),_.add(k.material3,"clearcoatRoughness",0,1).onChange(F),_.addColor(k.material3,"sheenColor").onChange(F),_.add(k.material3,"sheenRoughness",0,1).onChange(F),_.add(k.material3,"matte").onChange(F),_.add(k.material3,"castShadow").onChange(F),_.add(k.material3,"iridescence",0,1).onChange(F),_.add(k.material3,"iridescenceIOR",.1,3).onChange(F),_.add(k.material3,"iridescenceThickness",0,1200).onChange(F),_.close(),E()}();
//# sourceMappingURL=materialBall.2d30a0c5.js.map
